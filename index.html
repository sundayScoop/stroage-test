<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Storage Access API Tester – Parent</title>
</head>
<body>
  <h1>Parent (GitHub Pages)</h1>
  <p>This page embeds the <strong>child</strong> on <code>http://localhost:8080</code> as a third‑party iframe.</p>

  <iframe
    id="childFrame"
    src="http://localhost:8080/child.html"
    width="600"
    height="500"
    sandbox="allow-scripts allow-same-origin allow-storage-access-by-user-activation">
  </iframe>

  <script>
    // Only accept messages from our localhost child
    const CHILD_ORIGIN = 'http://localhost:8080';

    window.addEventListener('message', e => {
      if (e.origin !== CHILD_ORIGIN) return;

      const msg = e.data;
      // Popup request
      if (msg && msg.action === 'openPopup') {
        const popupUrl = `${CHILD_ORIGIN}/child.html?popup=1`;
        window.open(popupUrl, 'saa-popup', 'width=500,height=500');
      }
      // Redirect request
      else if (msg && msg.action === 'redirect' && msg.url) {
        window.location.href = msg.url;
      }
    });
  </script>
</body>
</html>
